I"$<div class="row">
  <div class="col grid s12 m6 l3" height="">
    <img src="/data-challenge/images/db_python.png" class="responsive-img" style="padding-top: 20px" />
  </div>
  <div class="col grid s12 m6 l9 ">
    Pour ceux √† l'aise en SQL, il peut √™tre pertinent d'importer dans un premier temps le jeu de donn√©es au sein d'une base de donn√©es pour conduire une premi√®re phase d'exploration et de manipulation.<br />
    	<br />
    Une fois cette premi√®re phase r√©alis√©e, Python sera utilis√© pour une deuxi√®me phase d'analyse, l'exploitation et le rendu de la donn√©e.
  </div>
</div>

<ul>
  <li><big>Au sein Microsoft Windows</big>
    <ul>
      <li>j‚Äôopterai pour <a href="https://www.microsoft.com/fr-fr/sql-server/sql-server-editions-express">SQL Server 2017 Express Edition</a> comme syst√®me de base de donn√©es</li>
      <li>et <a href="https://docs.microsoft.com/fr-fr/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-2017">SQL Server Management Studio (SSMS)</a> pour l‚Äôadministrer et l‚Äôinterroger.</li>
    </ul>
  </li>
  <li><big>Au sein d‚Äôun environnement Linux ou Mac OS</big>
    <ul>
      <li>j‚Äôopterai pour une base de donn√©es PostgreSQL</li>
      <li>et pgAdmin 4 pour l‚Äôadministrer et l‚Äôinterroger.</li>
    </ul>
  </li>
</ul>

<h2 id="exemple-sous-windows">Exemple sous Windows</h2>

<h4 id="installation-de-microsoft-sql-server-et-ssms">Installation de Microsoft SQL Server et SSMS</h4>
<p>T√©l√©charger <b><a href="https://www.microsoft.com/fr-fr/sql-server/sql-server-editions-express">SQL Server 2017 Express Edition</a></b>.</p>

<p>Lancez l‚Äôex√©cutable et suivez les instructions d‚Äôinstallation.</p>

<p>Suite √† cette installation votre ordinateur aura besoin de red√©marrer.</p>

<p>Une fois red√©marr√©, dans la m√™me langue que votre installation SQL Server t√©l√©chargez et installez <b><a href="https://docs.microsoft.com/fr-fr/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-2017">SQL Server Management Studio</a></b>.</p>

<p>Une fois install√©, ouvrez <b>SQL Server Management Studio</b> (menu <b>D√©marrer &gt; Microsoft SQL Server Tools 17 &gt; Microsoft SQL Server Management Studio</b>).</p>

<p>Une instance de Microsoft SQL Server Express devrait automatiquement √™tre d√©tect√©e et propos√©e √† la connexion (dans le cas contraire <b>Nom du serveur &gt; Parcourir‚Ä¶ &gt; Moteur de base de donn√©es &gt; DESKTOP-XXXXX</b>).</p>

<p>Cliquez sur <b>Connexion</b>.</p>

<h4 id="importation-des-donn√©es-en-base-de-donn√©es">Importation des donn√©es en base de donn√©es</h4>

<p>Cr√©ez une nouvelle base de donn√©es depuis l‚Äô<b>Explorateur d‚Äôobjets</b>  en faisant un clic droit sur le dossier <b>Base de donn√©es</b>.</p>

<p>Donnez lui un nom. et cliquez sur <b>OK</b>.</p>

<p>Faites un <b>clic droit</b> sur votre nouvelle base de donn√©es <b>&gt; T√¢ches &gt; Importer des donn√©es‚Ä¶</b>
<img src="/data-challenge/images/04-exploitation-des-donnees-au-sein-d-une-bdd/02-exploitation-des-donnees-au-sein-d-une-bdd.png" class="responsive-img" style="padding-top: 20px" /></p>

<p>S√©lectionnez pour <b>Source de donn√©es : Source du fichier plat</b>.</p>

<p><b>Suivant</b></p>

<p>Comme nom de fichier, allez chercher via le bouton <b>Parcourir‚Ä¶</b> le <a href="/data-challenge/data/data.zip">fichier data.csv</a> (s√©lectionnez le format de Fichiers CSV) pr√©alablement t√©l√©charg√© et d√©compress√©.</p>

<p><b>Ouvrir</b></p>

<p>Assurez-vous que le champ <b>Page de codes</b> ait bien la valeur : <b>65001 (UTF-8)</b>.
<img src="/data-challenge/images/04-exploitation-des-donnees-au-sein-d-une-bdd/03-exploitation-des-donnees-au-sein-d-une-bdd.png" class="responsive-img" style="padding-top: 20px" /></p>

<p>Via l‚Äôonglet <b>Avanc√©</b>, modifiez uniquement le <b>DataType</b> de la colonne <b>Statut op√©rationnel</b> en <b>cha√Æne Unicode [DT_WSTR]</b>.
<img src="/data-challenge/images/04-exploitation-des-donnees-au-sein-d-une-bdd/04-exploitation-des-donnees-au-sein-d-une-bdd.png" class="responsive-img" style="padding-top: 20px" /></p>

<p><b>Suivant</b></p>

<p><b>Destination : SQL Server Native Client 11.0</b></p>

<p><b>Suivant</b></p>

<p>Cliquez sur <b>Modifier les mappages‚Ä¶</b>.</p>

<p>Modifiez le type de la colonne <b>Statut op√©rationnel</b> en <b>nvarchar</b>.</p>

<p><b>OK</b></p>

<p><b>Suivant</b></p>

<p><b>Terminer</b></p>

<p>Dans l‚Äô<b>Explorateur d‚Äôobjets</b>, suite un dans l‚ÄôExplorateur d‚Äôobjets sur le nom de la base de donn√©es <b>&gt; Actualiser</b> vous devriez voir apparaitre votre table : <b>dbo.data</b>.</p>

<p>Vous pouvez y v√©rifier les donn√©es par un clic droit sur le nom de la table <b>&gt; S√©lectionner les 1000 premi√®re lignes</b>.
<img src="/data-challenge/images/04-exploitation-des-donnees-au-sein-d-une-bdd/05-exploitation-des-donnees-au-sein-d-une-bdd.png" class="responsive-img" style="padding-top: 20px" /></p>

<p>Nos donn√©es ont bien √©t√© charg√©es mais les types ne sont pas optimaux.</p>

<p>Nous allons donc cr√©er une nouvelle table b√©n√©ficiant des typages adapt√©s.</p>

<p>Faites un clic droit sur votre table <b>&gt; G√©n√©rer un script de la table en tant que &gt; CREATE To &gt; Nouvelle fen√™tre d‚Äô√©diteur de requ√™te</b>.</p>

<p>Et modifiez ce dernier de la mani√®re suivante (ici un sh√©ma d√©di√© a √©t√© cr√©√©).</p>

<pre><code class="language-sql">USE [data-challenge]
GO

/****** Object:  Table [dbo].[data]    Script Date: 15/12/2018 10:25:00 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE SCHEMA BSPP
GO

CREATE TABLE [BSPP].[data](
	[Date] [Datetime] NULL,
	[Longitude] float NULL,
	[Latitude] float NULL,
	[V√©hicule de secours] int NULL,
	[Famille de v√©hicule de secours] [varchar](50) NULL,
	[Statut op√©rationnel] [nvarchar](50) NULL,
	[Num√©ro Intervention] int NULL,
	[Type d'intervention] [varchar](50) NULL,
	[Disponibilit√© du moyen de secours] bit NULL,
	[Centre de secours] int NULL
) ON [PRIMARY]
GO
</code></pre>

<p>Ins√©rez √† votre nouvelle table les donn√©es correctement format√©es.</p>
<pre><code class="language-sql">SET DATEFORMAT ymd

INSERT INTO [BSPP].[data]
SELECT CONVERT(datetime, [Date], 121)
	,IIF([Longitude] NOT LIKE 'NULL', CAST([Longitude]  As float), NULL)
	,IIF([Latitude] NOT LIKE 'NULL', CAST([Latitude]  As float), NULL)
	,IIF([V√©hicule de secours] NOT LIKE 'NULL', CAST([V√©hicule de secours] As INT), NULL)
	,IIF([Famille de v√©hicule de secours] NOT LIKE 'NULL', [Famille de v√©hicule de secours], NULL)
	,IIF([Statut op√©rationnel] NOT LIKE 'NULL', [Statut op√©rationnel], NULL)
	,IIF([Num√©ro Intervention] NOT LIKE 'NULL', CAST([Num√©ro Intervention] As INT), NULL)
	,IIF([Type d'intervention] NOT LIKE 'NULL', [Type d'intervention], NULL) As [Type d'intervention]
	,IIF([Disponibilit√© du moyen de secours] NOT LIKE 'NULL', CAST([Disponibilit√© du moyen de secours] AS BIT), NULL)
	,IIF([Centre de secours] NOT LIKE 'NULL', CAST([Centre de secours] AS INT), NULL)
FROM [data-challenge].[dbo].[data] 
</code></pre>

<p>Vous pouvez d√©sormais manipuler de mani√®re optimale au sein de SQL Server Management Studio.</p>

<h4 id="interrogation-de-sql-server-√†-partir-dun-jupyter-notebook">Interrogation de SQL Server √† partir d‚Äôun Jupyter Notebook</h4>

<p>Une fois votre premi√®re phase d‚Äôanalyse et de manipulation au sein de SQL Server Management Studio r√©alis√©e, vous voudrez pouvoir requ√™ter votre base de donn√©es Microsoft SQL Server √† partir du Jupyter Notebook.</p>

<p>Pour interroger SQL Server en Python vous pouvez utiliser le package <code>pymmsql</code> (ce package distribu√© sous conda-forge n‚Äôest destin√© qu‚Äôaux plateformes linux-64 et osx-64, optez donc pour celui distribu√© par anaconda).</p>
<pre><code class="language-console">conda install -c anaconda pymssql
</code></pre>

<p>Pour ex√©cuter tr√®s simplement des requ√™tes SQL au sein d‚Äôun Jupyter Notebook vous pouvez utiliser le package <code>ipython-sql</code>.</p>
<pre><code class="language-console">conda install -c conda-forge ipython-sql
</code></pre>

<div class="card-panel teal lighten-4">
La possibilit√© de cr√©er un <a href="https://conda.io/docs/user-guide/tasks/manage-environments.html">environnement</a> avec Anaconda pour ce package m'a pos√© des probl√®mes, j'ai donc utilis√© l'environnement Python 3.7 par d√©faut.
</div>

<p>Dor√©navant au sein d‚Äôun Jupyter Notebook, vous pouvez saisir des requ√™tes SQL de la mani√®re suivante :</p>
<center><img src="/data-challenge/images/04-exploitation-des-donnees-au-sein-d-une-bdd/01-exploitation-des-donnees-au-sein-d-une-bdd.png" class="responsive-img" style="padding-top: 20px" /></center>

<p><b>Cha√Ænes de connexion</b></p>

<ul>
  <li>sans identifiants
    <pre><code class="language-console">%sql mssql+pyodbc://@serveur/base_de_donnees?driver=SQL+Server+Native+Client+11.0
</code></pre>
  </li>
  <li>avec identifiants
    <pre><code class="language-console">%sql mssql+pyodbc://login_utilisateur:mot_de_passe@serveur/base_de_donnees?driver=SQL+Server+Native+Client+11.0
</code></pre>
  </li>
</ul>

<p style="text-align: right;"><a href="/data-challenge/defi.html">Acc√©der au challenge <i class="material-icons" style="vertical-align:middle">fast_forward</i></a></p>

:ET